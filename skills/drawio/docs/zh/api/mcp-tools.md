# MCP 工具参考

所有可用 MCP 工具的完整参考。

## 可用工具

### start_session

打开 Draw.io 桌面应用并建立实时预览会话。

**用法**：创建新图表时自动调用

**参数**：无

**示例**：
> "启动一个新的图表会话"

---

### display_diagram

从 XML 标记创建新图表。

**参数**：
- `xml`（字符串）：Draw.io XML 格式的图表定义

**示例**：
> "创建一个包含开始、处理和结束节点的流程图"

Claude 将生成适当的 XML 并调用此工具。

---

### get_diagram

检索当前图表 XML。

**参数**：无

**返回**：当前图表的完整 XML 表示

**用例**：
- 将图表保存到文件
- 检查图表结构
- 修改特定元素

---

### edit_diagram

通过单元格 ID 修改现有图表。

**参数**：
- `cellId`（字符串）：要修改的单元格的 ID
- `xml`（字符串）：单元格的新 XML 内容

**示例**：
> "将节点 J5 的文本更改为'新标签'"
> "将单元格 J3 的填充颜色设置为 #FF6B6B"

---

### export_diagram

将当前图表保存为 .drawio 文件。

**参数**：
- `filename`（字符串）：输出文件路径

**示例**：
> "将图表导出为 ~/Documents/my-diagram.drawio"

## 工作流程

### 创建图表

1. `start_session` - 初始化会话
2. `display_diagram` - 渲染初始图表
3. 浏览器预览自动打开

### 编辑图表

1. `get_diagram` - 检索当前状态（可选）
2. `edit_diagram` - 进行定向更改
3. 预览实时更新

### 保存图表

1. `export_diagram` - 保存到文件系统
2. 文件以 .drawio XML 格式保存

## 最佳实践

### 工具选择

- 使用 `display_diagram` 创建新图表
- 使用 `edit_diagram` 进行修改
- 需要检查结构时使用 `get_diagram`

### 高效编辑

- 尽可能在单个 `edit_diagram` 调用中进行多次更改
- 按单元格 ID 批量编辑以获得更好的性能
- 在保存前使用浏览器预览验证更改

### 错误处理

如果工具失败：
1. 检查 Draw.io 桌面应用是否正在运行
2. 验证 MCP 服务器是否已连接
3. 确保单元格 ID 有效

## 技术细节

### XML 格式

Draw.io 使用基于 XML 的格式。详情请参阅 [XML 格式参考](./xml-format)。

### 单元格 ID

图表中的每个元素都有唯一的单元格 ID（例如 "J5"、"J12"）。
创建图表时会自动生成 ID。

### 会话管理

一次只能有一个活动会话。
启动新会话将关闭任何现有会话。

## 下一步

- 了解 [XML 格式](./xml-format)
- 浏览[示例](../examples/)
